import numpy as np
from ManifoldDR.util import help
from scipy.stats import kruskal, mannwhitneyu
import matplotlib.pyplot as plt

def ave(array):
    result = []
    for i in range(len(array[0])):
        result.append(np.mean(array[:, i]))
    return result


def final(DECC_L, DECC_LM):
    DECC_L_final = DECC_L[:, len(DECC_L[0])-1]
    DECC_LM_final = DECC_LM[:, len(DECC_LM[0]) - 1]

    print('DECC_L final: ', '%e' % np.mean(DECC_L_final), '±', '%e' % np.std(DECC_L_final, ddof=1))
    print('DECC_LM final: ', '%e' % np.mean(DECC_LM_final), '±', '%e' % np.std(DECC_LM_final, ddof=1))


def Normalization(Matrix):
    max_len = 0
    for v in Matrix:
        max_len = max(max_len, len(v))
    for v in Matrix:
        while len(v) < max_len:
            value = v[0]
            v.insert(0, value)
    return Matrix


def draw_summary(x_DECC_L, x_DECC_LM, DECC_L_ave, DECC_LM_ave):
    plt.rcParams['font.sans-serif'] = ['SimHei']
    plt.rcParams['axes.unicode_minus'] = False

    plt.semilogy(x_DECC_L, DECC_L_ave, label='従来法1', linestyle=':')
    plt.semilogy(x_DECC_LM, DECC_LM_ave, label='提案法1', color='red')

    font_title = {'size': 18}
    font = {'size': 16}
    plt.title('$f_{15}$', font_title)
    plt.xlabel('Fitness evaluation times (×${10^6}$)', font)
    plt.ylabel('Fitness', font)
    plt.legend()

    plt.show()


if __name__ == '__main__':
    DECC_L = [[88631715573301.56, 83618374206034.98, 71792497328272.89, 58590001539356.016, 54756950103431.75, 49952809937177.74, 47930954606812.625, 46498035031101.93, 38525308319831.36, 30884753669289.76, 29457407158813.92, 20702909172897.5, 18390086029235.504, 17938121087888.293, 16475852012632.098, 15058868884982.16, 14929936140107.477, 11921920408901.613, 11823649696191.16, 10238870468293.857, 8367403970840.474, 8255794802685.866, 7483318175635.204, 7378240129708.748, 6975109641208.917, 6567016746417.832, 5692006097151.497, 5472273478448.245, 5200292147279.066, 4082674003233.771, 3555252491295.2324, 3433918969619.059, 3322029380072.1816, 3293358359207.606, 2753160764416.371, 2753160764416.371, 2699624662799.0957, 2532880901390.809, 2387089168495.5723, 2357709166014.1235, 2031535094621.8577, 2031535094621.8577, 2031535094621.8577, 1982996996667.3604, 1874340362415.6711, 1662782496649.3777, 1555949300968.786, 1541574135177.582, 893486534981.7223, 839730537597.841, 831189641645.6758, 831189641645.6758, 819381396602.4818, 799083135107.7236, 784457024197.7037, 773715726668.9482, 646918576325.0934, 601764128594.0292, 591507784148.5374, 393157655100.38403, 386170567735.96497, 358963540112.8707, 358963540112.8707, 348099528546.63873, 334470715678.4491, 321368837247.14734, 308155048590.0038, 239629679435.68457, 236688832030.96942, 215128557856.8259, 212871656008.31665, 115128604150.84984, 110645144875.13141, 108505685059.60991, 102582598322.9675, 51390968263.354065, 47419016418.50707, 45923620596.87588, 43385033495.47281, 41704129175.75908, 40501909027.452934, 39006619256.18532, 37441169974.207794, 37441169974.207794, 36774860104.81991, 35124613452.530266, 31504972110.483288, 31504972110.483288, 22330721717.088696, 21994628737.47149, 20794892262.354027, 20794892262.354027, 20249547435.62358, 19705389228.085506, 17229650021.561394, 17229650021.561394, 14025724567.301311],
[92207130843235.23, 75103377990941.36, 72387158258465.1, 67289489335977.54, 54771992506463.305, 46722226977844.68, 44568517714258.336, 40594301770077.97, 39555241897971.164, 34011527892649.64, 33209294919827.438, 31040205695416.844, 30112777295206.94, 28274398928311.69, 26288485591006.332, 24008773450587.484, 21670800976766.79, 20316470573403.04, 19444055233436.21, 17715273392088.215, 16387097455401.32, 14244032911508.04, 13142784166823.941, 12756362267527.805, 8565490402969.109, 8151383685662.815, 7694695040383.133, 6689701903617.392, 6469065880454.443, 5682054984012.651, 5682054984012.651, 5682054984012.651, 3094694948146.099, 3074884661356.2417, 3012089725474.569, 2970235498122.3315, 2952668166054.376, 2882555449570.309, 2826459691611.0303, 2793455460754.4355, 2560999438720.8765, 2449323962718.386, 2302928388144.2993, 1063514931852.4357, 1001872256442.7053, 939880518321.4717, 925734887696.9863, 925734887696.9863, 913485603296.9169, 860099592275.7207, 850631262807.376, 691519202721.6168, 669743088315.1249, 636667987708.9309, 620268459184.2565, 605323391545.2395, 594759707132.6089, 586089784980.6046, 579967994233.4047, 552412182997.5078, 520898203611.93823, 510049492040.2694, 507855931128.37585, 443607770008.0831, 409102260678.2523, 306611375239.4449, 128050912020.78441, 116283627613.14363, 110894182681.26617, 110860897054.42552, 49627584447.60279, 49440133981.22987, 46760840555.260796, 44115108389.57358, 44115108389.57358, 44115108389.57358, 43918233718.65414, 37503038142.246826, 36060918483.459564, 35828534911.886826, 34394527861.4713, 34394527861.4713, 31863051472.359035, 31863051472.359035, 31549243547.006824, 30983373522.432205, 28895861990.84888, 28895861990.84888, 28895861990.84888, 28268619357.468056, 27837811318.097248, 27837811318.097248, 27740546947.099255, 27740546947.099255, 27740546947.099255, 27740546947.099255, 27740546947.099255],
[93351236273604.9, 83363517548401.02, 81958344393681.52, 74412466000922.77, 70903440558647.05, 61799624224734.61, 56793998507177.87, 55745038861625.91, 54059564207603.07, 48466378473961.93, 28220185349431.297, 26894673128733.363, 25677736679660.08, 25061998322242.207, 24756951298436.605, 22275156694328.82, 21511785942270.37, 21183436201450.29, 20781641316701.86, 19343868216311.117, 18764100106885.65, 16903136156180.814, 14657026528022.7, 13524918733709.549, 12223216771766.148, 11739810781816.002, 6629442339602.402, 6499335593795.087, 6113662407713.125, 5813252513621.135, 5396544468930.516, 5283591643545.389, 5283591643545.389, 1945364735374.218, 1691636912348.361, 1665840495410.978, 1547069830853.761, 1354768131784.3657, 1208121884824.878, 1129788718468.7878, 1129788718468.7878, 1063530678825.6989, 698391722235.1255, 590945752380.0637, 536101260620.92596, 529609359330.41345, 493940930435.7578, 481968254249.19037, 454937691587.46356, 385125996051.87115, 378028647697.4563, 378028647697.4563, 370309713909.5995, 337054484965.9009, 307604970328.88544, 291175202478.74396, 221636209238.88614, 214952277716.19943, 205672744532.4198, 201784039848.85678, 113420520938.15385, 54317013971.15838, 48657769658.01833, 40268069723.075424, 38917178126.179985, 35062020661.04437, 35062020661.04437, 29756769608.5636, 26596156527.854416, 26596156527.854416, 26596156527.854416, 26596156527.854416, 26596156527.854416, 25674671788.843872, 23308800598.874424, 23308800598.874424, 23308800598.874424, 21811739733.679874, 18706995624.67707, 18360542907.12222, 17839427614.670135, 17612009270.94597, 14439590559.257395, 14439590559.257395, 13995126951.610142, 13705775005.76945, 13705775005.76945, 13705775005.76945, 13705775005.76945, 12750215701.49429, 12750215701.49429, 12750215701.49429, 12750215701.49429, 12750215701.49429, 12750215701.49429, 12750215701.49429, 12750215701.49429],
[117746627116494.02, 110652155941032.22, 86031078231820.02, 81472465513744.52, 73414234037682.72, 64974495124364.375, 61258598570924.984, 56945641797478.73, 50916804456217.46, 39179690701479.56, 39008807026414.95, 36882343365979.7, 35731135234946.94, 32672146893520.89, 30182044586172.97, 24708523200386.086, 20405691662097.723, 19694981118019.39, 17307466290520.389, 12561095500295.709, 11402759898843.088, 10896568146286.46, 10819729919890.178, 7051313222136.591, 6967283697462.324, 6967283697462.324, 6967283697462.324, 6967283697462.324, 6483054376251.268, 6415947650241.176, 6377690115546.125, 6348069225097.465, 5903925240232.358, 5682748993480.934, 5609465655086.404, 5565051943656.994, 5539822882859.692, 5464783582545.687, 5464783582545.687, 5253865904965.268, 5161528303377.928, 2777370288294.4175, 2709853606924.415, 2701186679885.7993, 2660694166472.999, 2635184439136.946, 1077505506280.8501, 968942547647.82, 899425552376.2462, 858163746273.3499, 848086564696.582, 834334914720.6674, 808241800391.0906, 774124872340.4369, 764143758685.7079, 745449845434.8784, 599729244060.8961, 566112864649.2653, 558423124632.6713, 542723305439.38556, 516192574023.8095, 489638663372.16376, 482297497534.7053, 320510067718.36285, 316071586875.82983, 316071586875.82983, 191406767519.84708, 184766476560.83707, 175561483112.549, 156963392782.58456, 155054951667.6433, 155054951667.6433, 155054951667.6433, 155054951667.6433, 118595534260.50565, 113292494598.49065, 111657949284.41203, 102260997665.55771, 101005005170.58076, 99935952228.03545, 96101520614.0526, 57060927273.38425, 54099012865.65605, 49441160062.00564, 49441160062.00564, 49441160062.00564, 13245724374.782999, 13245724374.782999, 13245724374.782999, 13245724374.782999, 13245724374.782999, 13245724374.782999, 13245724374.782999, 13245724374.782999, 12752823372.436512, 12746074510.912922, 12746074510.912922],
[81502245351255.11, 75842550955530.02, 68297011078486.09, 61862074061426.195, 50935223639596.04, 43054598532691.7, 42125134032965.85, 40968963164658.48, 35633033052863.87, 32605294506599.246, 28262401845636.766, 26200423038865.91, 24637380849537.953, 15610552453116.072, 12961452827398.943, 12784059288831.344, 12404984183617.945, 12059771394643.21, 11387436988001.457, 10936409483380.139, 10512238628631.627, 10380647791801.334, 10309798120394.857, 10309798120394.857, 10309798120394.857, 10309798120394.857, 10037297066953.395, 5680204050812.831, 5559145093915.137, 1952362787284.8965, 1866353994793.5715, 1767792551130.1006, 1692265382897.5413, 1669582505924.5332, 1628429658661.769, 1622592618008.9556, 1425029876260.5159, 1368529212341.4482, 1192597075434.965, 1175128261082.6653, 875835589472.2275, 875835589472.2275, 841323762875.3112, 797249962784.1687, 752426380568.8135, 709806852671.2526, 696643785012.3173, 642906986331.36, 642906986331.36, 624041258457.0621, 577412084366.4862, 560230411563.4113, 555113841785.4131, 542184904283.43835, 522353948112.27734, 512735206765.052, 510925707451.5761, 510925707451.5761, 451634451498.85474, 434477019463.8684, 434477019463.8684, 415387502691.66223, 411493839924.77924, 410771718326.3207, 410771718326.3207, 410771718326.3207, 410771718326.3207, 410771718326.3207, 204768769110.19373, 204768769110.19373, 197767166751.2075, 193170671987.02896, 188151350932.11856, 93572495386.48973, 84037514557.42868, 82165960434.92688, 82165960434.92688, 66419405231.94813, 62320603666.482864, 61445485682.58606, 60457107045.786705, 57316228678.958565, 53555142703.24076, 53042095577.92325, 51498260092.151, 51498260092.151, 50783802663.10141, 33497657683.055508, 32192399626.216396, 32048508507.064182, 31317036616.82774, 30212528916.00914, 19840415266.364613, 19360601593.34896, 19360601593.34896, 19360601593.34896, 19360601593.34896]
]

    DECC_LM = [[81979479071132.98, 66332344548586.31, 57907247522713.03, 53557326276562.15, 49613687722706.52, 44887637532704.3, 43154476974202.07, 33859422120017.6, 27006192306180.664, 25496956881732.77, 25496956881732.77, 13870827441625.375, 11789835551180.5, 10152428324874.607, 9911526954786.037, 9389182918671.977, 7242603755508.874, 5052475673769.728, 4482443343741.188, 3698449911079.9736, 3248166789493.1904, 2729264158897.115, 1746740520071.1387, 1664746621483.6624, 1478249034086.7173, 1420425461151.551, 1260520163382.6833, 1022935616319.4032, 806205909315.2715, 770448142674.1556, 667895445516.1691, 602860404970.0192, 570389531610.8184, 570389531610.8184, 569794587799.4017, 454600978212.7935, 432540190815.7606, 372418639863.4672, 350887103748.19794, 335400130058.7056, 280907771204.38934, 237349109349.01938, 215373991697.8927, 215373991697.8927, 194842601068.11276, 160910318081.38974, 146633745184.77756, 134108309503.51097, 130465083030.43617, 126851847495.77664, 123740685325.36345, 123116143809.20322, 122359177657.84459, 96632295328.4754, 95837415936.98984, 86984530866.4961, 86984530866.4961, 84148519800.80746, 72852297159.81268, 72852297159.81268, 67703515807.965355, 66492898606.39256, 56927766827.37093, 51455912778.43407, 51266487068.42453, 50410211670.07651, 40624437994.429665, 39687214322.338356, 38577635657.055534, 35547699005.88335, 35119080188.115036, 29952420797.750824, 29739351140.980778, 27708012004.498463, 23620977883.467285, 23082202959.328533, 21230240514.706436, 21230240514.706436, 21230240514.706436, 14632163198.517647, 14632163198.517647, 14632163198.517647, 13530654966.733084, 13416544245.198698, 13416544245.198698, 13352362967.624483, 13287104053.158413, 13287104053.158413, 13287104053.158413, 13287104053.158413, 11936540874.350868, 11936540874.350868, 11936540874.350868, 11936540874.350868, 11936540874.350868, 11936540874.350868],
[84798140632615.14, 65387274963842.04, 49358841194908.625, 47340435048083.914, 41512054757235.43, 37014396719330.4, 36293841732034.32, 32141836820685.273, 30398145080729.336, 28946493877693.46, 24367886940347.47, 16469159432353.713, 13382462098055.873, 10638995478718.984, 9716050996281.053, 8552684012661.167, 6544744172859.841, 5546607010136.364, 4678969260199.817, 4278412833171.067, 3778921064583.684, 3242335188181.8286, 2484122521845.957, 2351294303581.9287, 2306177846910.7817, 2220405804203.4634, 1856942231765.0376, 1621643797092.3032, 1475576217228.0808, 1163550959394.978, 1134865215293.1233, 910430497640.5082, 807388682927.2681, 723136740164.3956, 670523536930.0664, 614003798320.469, 565305179209.5696, 472253147988.4993, 441136175730.73804, 441136175730.73804, 432544591021.33264, 382149980362.0311, 328842304588.34717, 321167821595.7104, 300609736820.34143, 236723848555.4959, 209876036272.99774, 182968779414.71088, 156690058630.40497, 155253681772.93256, 144171307028.94205, 133653440726.51657, 128434578196.27534, 121985825662.90594, 103955878585.21721, 97351637994.58754, 97351637994.58754, 86063639281.08292, 84117919861.24046, 66638675763.34917, 66638675763.34917, 65288030149.38727, 65288030149.38727, 62081036580.686775, 61442549054.8205, 59672143411.56821, 50845429334.16843, 49066776856.541855, 41665024848.42137, 39768707856.8784, 38841572261.13033, 35488707076.74206, 34093686212.88009, 26169103336.636883, 25658047431.327694, 23763537781.936066, 22571308376.270943, 22029970363.869297, 18085616201.947304, 17830422551.786976, 17029840832.810602, 17029840832.810602, 17029840832.810602, 17029840832.810602, 16533365806.638802, 15485426255.637768, 15414504337.010492, 15414504337.010492, 15414504337.010492, 15414504337.010492, 15414504337.010492, 15414504337.010492, 15414504337.010492, 15414504337.010492, 15414504337.010492, 14644744466.71601],
[85847709776461.12, 74169559394082.53, 67868107673736.26, 60986770854287.234, 49680026401144.06, 45460063104648.29, 27367373419560.39, 25383424235999.48, 24761980675725.176, 23165111159031.453, 18990638032732.727, 18894981168707.746, 14167695615993.025, 13729058269075.588, 10517469329883.932, 9788862591188.434, 5914031623308.521, 4041926919355.5156, 3744160359793.57, 3667647730101.2427, 2809721407580.42, 2297960340801.6055, 2042835330806.0754, 2009383689203.209, 1897550585972.7217, 1808228649720.2488, 1750140759734.4805, 1567017572788.4465, 1431974106159.589, 1297367934851.5173, 1248506828632.8208, 1158412112243.7117, 909504386714.8949, 870927776700.201, 653282262262.407, 621432666117.1644, 598387817731.9298, 577217521238.2269, 564977848644.8038, 564977848644.8038, 564977848644.8038, 518881201441.86884, 481052258667.8644, 468842171602.7442, 375977102883.54126, 306990468870.61584, 296724872904.0587, 268459887836.40277, 261456504226.26828, 235572197189.7378, 235572197189.7378, 200792582429.2833, 186040259753.13492, 186040259753.13492, 124442109960.50116, 120213842242.49144, 114500691613.2962, 114500691613.2962, 110722069634.21773, 106172803149.24449, 94578560639.5504, 84436071977.99678, 74344735682.33116, 74344735682.33116, 74344735682.33116, 67342947588.3062, 52295458946.50823, 52070228455.960106, 48543079182.689354, 44552935593.922226, 42382913382.128654, 40702067197.600136, 33379339955.761135, 33254035204.133606, 32956205563.971237, 32956205563.971237, 31705821138.638504, 29717855838.774166, 25802825001.453373, 25752455433.765083, 23655132334.067352, 22304258060.95814, 21879267576.86905, 18358370300.312065, 18332692249.0239, 18332692249.0239, 18332692249.0239, 15936445425.051931, 15891595924.494038, 15891595924.494038, 15891595924.494038, 14103655053.819561, 13456523346.449697, 13456523346.449697, 13456523346.449697, 13456523346.449697],
[78762504604453.44, 62969707425696.445, 50309607840262.29, 46172645411559.266, 36387542906430.945, 35064928237391.17, 30012494570427.69, 22888635122431.723, 21172511561506.438, 20507176192992.734, 17225653603077.271, 15055919607902.074, 14423932716457.111, 14244989898687.621, 11695159046268.451, 11116734095063.963, 8928044382248.12, 8046757003513.838, 7387855340373.076, 6689293512067.368, 5639732403689.057, 4478995578309.458, 3146589860727.0757, 2062386260466.8445, 1403671099194.616, 1354174104461.241, 1099237579269.3096, 1075709186751.8859, 809606327513.5238, 779252045467.7544, 696468748544.3351, 653765872042.0287, 597504342717.5089, 524012640454.6646, 474189801092.129, 417926120618.11066, 388219522014.21173, 378599149380.65155, 352354953462.2156, 317139908609.5301, 304751088820.663, 281037495558.10504, 250898933313.10663, 250188096940.19547, 232585502032.24167, 223950786209.2537, 214664027643.8883, 199617581209.76242, 192978874415.0744, 183815384316.52924, 161838224169.56323, 156760093997.00156, 144540577485.44043, 130050710459.08711, 124441959006.83899, 124368877575.25105, 98208137037.60287, 88018113619.01154, 87898457613.33252, 85318202278.93091, 82360476472.1689, 73879695334.40437, 73448374435.07368, 68660546089.85971, 68660546089.85971, 68660546089.85971, 60987655254.08935, 52917684738.979645, 52917684738.979645, 52917684738.979645, 39820612688.34094, 38301543409.197525, 35508547183.124855, 34898433413.9655, 30333928903.689518, 29958740297.82425, 22950426243.568893, 20699038047.17033, 20699038047.17033, 19534674510.73725, 19123241715.67162, 17879286238.119003, 17512752647.18555, 17503394042.6995, 13577653240.454426, 13492172812.284193, 13207970858.884615, 13134343170.956585, 13134343170.956585, 13134343170.956585, 13134343170.956585, 13134343170.956585, 13134343170.956585, 13134343170.956585, 13134343170.956585, 13134343170.956585],
[71334048538936.73, 61598208407672.914, 52474715319522.0, 47893099668675.71, 43002473737036.25, 37394086361293.75, 34238218221071.97, 27639012819425.9, 26360901232027.652, 22498399235607.77, 22015621432731.926, 14481417506359.893, 10846721498204.459, 10600964984275.658, 9241709660328.45, 8679070295332.913, 8177923935928.987, 5865888409991.853, 5710102123662.075, 5277037895970.318, 5171608811477.911, 3794917700273.008, 3547151281598.4854, 2561696320830.037, 2516167832096.965, 2463702714504.3574, 2377317943020.3613, 1734174202860.1492, 1721360155758.6313, 1537267998287.4062, 1455707778981.5015, 1347297650958.3867, 1317889347751.1658, 1311534672106.1155, 1210928627832.8496, 1165241373060.903, 943564962700.1652, 649862672751.1567, 611738640932.0192, 591086508713.4427, 591086508713.4427, 591086508713.4427, 454053177938.5044, 454053177938.5044, 454053177938.5044, 382867461041.7174, 285407174671.9096, 277857387454.8526, 248966157584.3173, 246479209418.56213, 234980493736.53387, 170965784960.32626, 155564646492.0234, 142749924640.99246, 138760359637.957, 138760359637.957, 87232490601.49393, 75834231647.14026, 67925466276.23234, 65850211677.01616, 65850211677.01616, 57926553127.78208, 53892313731.389145, 48352539962.19946, 40998066775.735466, 39422480450.67598, 34462655939.93298, 32581511292.578026, 31191264093.268192, 29313566581.238834, 29313566581.238834, 24514905442.029987, 24479583761.929676, 23023470587.252373, 22185341934.825233, 19548478980.36831, 18320197363.659054, 18320197363.659054, 18320197363.659054, 17015991269.030737, 15305937827.139242, 15305937827.139242, 15305937827.139242, 15305937827.139242, 15305937827.139242, 15305937827.139242, 15305937827.139242, 15305937827.139242, 15305937827.139242, 15305937827.139242, 15305937827.139242, 14537393544.203993, 14537393544.203993, 13828693052.130909, 13828693052.130909, 13828693052.130909]
]

    DECC_L = np.array(Normalization(DECC_L))
    DECC_LM = np.array(Normalization(DECC_LM))

    final(DECC_L, DECC_LM)

    DECC_L_ave = ave(DECC_L)
    DECC_LM_ave = ave(DECC_LM)

    # Normal/One/DECC-G use same x
    LASSO_cost = 0

    bias = 30000

    x_DECC_L = np.linspace(LASSO_cost+bias, 3000000, len(DECC_L_ave))
    x_DECC_LM = np.linspace(LASSO_cost+bias, 3000000, len(DECC_LM_ave))

    draw_summary(x_DECC_L, x_DECC_LM, DECC_L_ave, DECC_LM_ave)

    # print('kruskal: ', kruskal(DECC_L[:, len(DECC_L[0])-1], Normal[:, len(Normal[0])-1],
    #               One[:, len(One[0])-1], DECC_DG[:, len(DECC_DG[0])-1], DECC_D[:, len(DECC_D[0])-1],
    #               DECC_G[:, len(DECC_G[0])-1]))
    #
    # print('Holm test: ', Holm(DECC_L[:, len(DECC_L[0])-1], Normal[:, len(Normal[0])-1],
    #               One[:, len(One[0])-1], DECC_DG[:, len(DECC_DG[0])-1], DECC_D[:, len(DECC_D[0])-1],
    #               DECC_G[:, len(DECC_G[0])-1], mannwhitneyu))
